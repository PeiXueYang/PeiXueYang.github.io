webpackJsonp([13],{Bubv:function(t,e){},VoTc:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Xxa5"),i=a.n(n),r=a("exGp"),s=a.n(r),o=a("//Fk"),c=a.n(o),l=function(t,e){var a=void 0,n={"Y+":e.getFullYear().toString(),"m+":(e.getMonth()+1).toString(),"d+":e.getDate().toString(),"H+":e.getHours().toString(),"M+":e.getMinutes().toString(),"S+":e.getSeconds().toString()};for(var i in n)(a=new RegExp("("+i+")").exec(t))&&(t=t.replace(a[1],1==a[1].length?n[i]:n[i].padStart(a[1].length,"0")));return t},u={data:function(){return{map:{},point:"",currentTime:"",columns1:[{title:"#",key:"Index",width:60,align:"center"},{title:"日期",key:"date",align:"center"},{title:"航线",key:"shipLine",align:"center"},{title:"货主",key:"name",align:"center"},{title:"货种",key:"cargo",align:"center"},{title:"吨位",key:"tons",align:"center"},{title:"运价",key:"freight",align:"center"}],columns2:[{title:"#",key:"Index",width:60,align:"center"},{title:"日期",key:"starDate",align:"center",width:200},{title:"航线",key:"shipLine",align:"center"}],data1:[],data2:[],currentPage:1,currentPage1:1,size:10,size1:10,total:10,total1:10,shipInfo:{lastVoyage:{createTime:"",loadPort:"",discPort:"",cargo:"",tons:""}}}},methods:{getShipHistory:function(){var t=this,e={mmsi:this.$route.query.mmsi};this.$http.getShipHistory(e).then(function(e){if(0==e.data.status){var a=e.data.result;a instanceof Array&&a.length&&(t.currentTime=a[a.length-1].postime);var n=[];if(a)new c.a(function(t,e){a.map(function(t,e){n[e]=new BMap.Point(t.lng,t.lat)}),t(n)}).then(function(e){var a=n[Math.ceil(n.length/2)];t.initMapNew(e,a)});else{var i=new Date;t.currentTime=l("YYYY/mm/dd HH:MM:SS",i),setTimeout(function(){t.initNoship()},100)}}else{setTimeout(function(){t.initNoship()},100);var r=new Date;t.currentTime=l("YYYY/mm/dd HH:MM:SS",r)}})},initMapNew:function(t,e){var a=this;this.map=new BMap.Map("map"),this.map.centerAndZoom(e,8);var n=new BMap.NavigationControl;this.map.addControl(n);var i=new BMap.Symbol(BMap_Symbol_SHAPE_BACKWARD_OPEN_ARROW,{scale:.7,strokeColor:"#fff",strokeWeight:"2"}),r=new BMap.IconSequence(i,"10","30");this.point=t,setTimeout(function(){a.drawLine(r)},1e3);var s=new BMap.Icon("http://feiyuhuopanguanjia.oss-cn-hangzhou.aliyuncs.com/houtai/ships.png",new BMap.Size(50,50),{anchor:new BMap.Size(10,10)}),o=t.length-1,c=new BMap.Point(t[o].lng,t[o].lat),l=new BMap.Marker(c,{icon:s});this.map.addOverlay(l),l.setAnimation(BMAP_ANIMATION_BOUNCE),this.map.setMapStyle({styleJson:[{featureType:"road",elementType:"all",stylers:{visibility:"off"}},{featureType:"water",elementType:"all",stylers:{color:"#afdafc"}},{featureType:"districtlabel",elementType:"all",stylers:{}}]})},initNoship:function(){var t=new BMap.Map("map"),e=new BMap.Point(116.4035,39.915);t.centerAndZoom(e,8);var a=new BMap.NavigationControl;t.addControl(a);var n={position:e,offset:new BMap.Size(260,-130)},i=new BMap.Label("暂无轨迹信息",n);n={width:250,height:100,title:"Hello"};i.setStyle({color:"red",fontSize:"14px",height:"20px",lineHeight:"20px",fontFamily:"微软雅黑"}),t.addOverlay(i),t.setMapStyle({styleJson:[{featureType:"road",elementType:"all",stylers:{visibility:"off"}},{featureType:"water",elementType:"all",stylers:{color:"#afdafc"}},{featureType:"districtlabel",elementType:"all",stylers:{}}]})},drawLine:function(t){var e=new BMap.Polyline(this.point,{strokeColor:"blue",strokeWeight:3,strokeOpacity:.5,icons:[t]});this.map.addOverlay(e)},changePage:function(t,e){1==e?(this.currentPage=t,this.hisCoorperation()):(this.currentPage1=t,this.hisLine())},sizeChange:function(t,e){1==e?(this.size=t,this.hisCoorperation()):(this.size1=t,this.hisLine())},getShipInfo:function(){var t=this;return s()(i.a.mark(function e(){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.shipInfoAndLostPosition({mmsi:t.$route.query.mmsi});case 2:(a=e.sent).data.status||(t.shipInfo=a.data.result);case 4:case"end":return e.stop()}},e,t)}))()},hisCoorperation:function(){var t=this;return s()(i.a.mark(function e(){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.shipHistoryOrder({mmsi:t.$route.query.mmsi,currentPage:t.currentPage,size:t.size});case 2:a=e.sent,t.data1=[],t.total=a.data.total,0===a.data.status&&a.data.result.forEach(function(e,a){t.data1.push({Index:Number((t.currentPage-1)*t.size)+Number(a)+1,date:e.createTime,shipLine:e.discPorts+"——"+e.loadPorts,name:e.contactName,cargo:e.cargo,tons:e.cargoTons,freight:e.freights})});case 6:case"end":return e.stop()}},e,t)}))()},hisLine:function(){var t=this;return s()(i.a.mark(function e(){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.shipHistoryVoyage({mmsi:t.$route.query.mmsi,currentPage:t.currentPage1,size:t.size1});case 2:a=e.sent,t.data2=[],t.total1=a.data.total,0===a.data.status&&a.data.result.forEach(function(e,a){t.data2.push({Index:Number((t.currentPage1-1)*t.size1)+Number(a)+1,starDate:e.data,shipLine:e.route})});case 6:case"end":return e.stop()}},e,t)}))()}},mounted:function(){this.getShipHistory()},created:function(){this.getShipInfo(),this.hisCoorperation(),this.hisLine()}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Card",{staticClass:"card"},[a("Breadcrumb",[a("BreadcrumbItem",[t._v("运力匹配")]),t._v(" "),a("BreadcrumbItem",[t._v("船舶详情")])],1),t._v(" "),a("Row",{staticClass:"box-container"},[a("Row",[a("Col",{attrs:{span:"1"}},[t._v("船舶")]),t._v(" "),a("Col",{attrs:{span:"8"}},[t._v(t._s(t.shipInfo.shipName)+"/"+t._s(t.shipInfo.mmsi))]),t._v(" "),a("Col",{attrs:{span:"1"}},[t._v("船东")]),t._v(" "),a("Col",{attrs:{span:"8"}},[t._v(t._s(t.shipInfo.shipOwnerName)+" /"+t._s(t.shipInfo.phone)+" ")])],1),t._v(" "),a("Row",{staticStyle:{position:"relative"}},[a("div",{ref:"map",attrs:{id:"map"}}),t._v(" "),a("h3",{staticClass:"infoWindow"},[t._v("更新日期 "+t._s(t.currentTime))])]),t._v(" "),a("Divider"),t._v(" "),a("h3",[t._v("最新航次")]),t._v(" "),a("Row",{staticClass:"row"},[a("Col",{attrs:{span:"1"}},[t._v("日期")]),t._v(" "),a("Col",{attrs:{span:"5"}},[t._v(t._s(t.shipInfo.lastVoyage.data?t.shipInfo.lastVoyage.data:"-"))]),t._v(" "),a("Col",{attrs:{span:"1"}},[t._v("航线")]),t._v(" "),a("Col",{attrs:{span:"15"}},[t._v(t._s(t.shipInfo.lastVoyage.route))])],1),t._v(" "),a("Divider"),t._v(" "),a("h3",[t._v("历史合作")]),t._v(" "),a("Row",{staticClass:"row"},[a("Table",{attrs:{border:"",columns:t.columns1,data:t.data1}}),t._v(" "),a("Page",{staticClass:"pages",attrs:{total:t.total,current:t.currentPage,"page-size":t.size,"show-elevator":"","show-sizer":""},on:{"on-page-size-change":function(e){return t.sizeChange(e,1)},"on-change":function(e){return t.changePage(e,1)}}})],1),t._v(" "),a("h3",[t._v("历史航线")]),t._v(" "),a("Row",{staticClass:"row"},[a("Table",{attrs:{border:"",columns:t.columns2,data:t.data2}}),t._v(" "),a("Page",{staticClass:"pages",attrs:{total:t.total1,current:t.currentPage1,"page-size":t.size1,"show-elevator":"","show-sizer":""},on:{"on-page-size-change":function(e){return t.sizeChange(e,2)},"on-change":function(e){return t.changePage(e,2)}}})],1)],1)],1)},staticRenderFns:[]};var h=a("VU/8")(u,p,!1,function(t){a("Bubv")},"data-v-58d8e035",null);e.default=h.exports}});
//# sourceMappingURL=13.f1bf7bb1e601eed83716.js.map